function analyzeImageForBestPosition(imgData, width, height) {
  const cols = 6;
  const rows = 6;
  const blockWidth = Math.floor(width / cols);
  const blockHeight = Math.floor(height / rows);

  let bestBlock = { x: 0, y: 0 };
  let minContrast = Infinity;

  for (let row = 0; row < rows; row++) {
    for (let col = 0; col < cols; col++) {
      let totalContrast = 0;
      let count = 0;

      for (let y = 0; y < blockHeight - 1; y += 2) {
        for (let x = 0; x < blockWidth - 1; x += 2) {
          const px = ((row * blockHeight + y) * width + (col * blockWidth + x)) * 4;
          const r = imgData[px];
          const g = imgData[px + 1];
          const b = imgData[px + 2];
          const brightness = (r + g + b) / 3;

          const pxRight = ((row * blockHeight + y) * width + (col * blockWidth + x + 1)) * 4;
          const r2 = imgData[pxRight];
          const g2 = imgData[pxRight + 1];
          const b2 = imgData[pxRight + 2];
          const brightness2 = (r2 + g2 + b2) / 3;

          totalContrast += Math.abs(brightness - brightness2);
          count++;
        }
      }

      const avgContrast = totalContrast / count;

      if (avgContrast < minContrast) {
        minContrast = avgContrast;
        bestBlock = { x: col, y: row };
      }
    }
  }

  const bestFontSize = Math.min(60, width / 20);
  const bestX = bestBlock.x * blockWidth + 20;
  const bestY = bestBlock.y * blockHeight + bestFontSize + 10;

  return { x: bestX, y: bestY, fontSize: bestFontSize };
}
